(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const d of e.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function a(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(t){if(t.ep)return;t.ep=!0;const e=a(t);fetch(t.href,e)}})();function A(){const n=document.getElementById("site-header"),m=document.getElementById("btn-auto"),a=document.getElementById("btn-dark"),r=document.getElementById("btn-light");if(!n||!m||!a||!r)return;const t=window.matchMedia("(prefers-color-scheme: dark)");let e="auto";function d(){[m,a,r].forEach(l=>l.classList.remove("is-active")),e==="auto"&&m.classList.add("is-active"),e==="dark"&&a.classList.add("is-active"),e==="light"&&r.classList.add("is-active")}function y(){document.body.classList.remove("dark-mode"),n.classList.remove("header--auto"),e==="auto"&&(t.matches&&document.body.classList.add("dark-mode"),n.classList.add("header--auto")),e==="dark"&&document.body.classList.add("dark-mode"),d()}t.addEventListener("change",()=>{e==="auto"&&y()}),m.addEventListener("click",()=>{e="auto",y()}),a.addEventListener("click",()=>{e="dark",y()}),r.addEventListener("click",()=>{e="light",y()}),y()}const I='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M305 151.1L320 171.8L335 151.1C360 116.5 400.2 96 442.9 96C516.4 96 576 155.6 576 229.1L576 231.7C576 343.9 436.1 474.2 363.1 529.9C350.7 539.3 335.5 544 320 544C304.5 544 289.2 539.4 276.9 529.9C203.9 474.2 64 343.9 64 231.7L64 229.1C64 155.6 123.6 96 197.1 96C239.8 96 280 116.5 305 151.1z"/></svg>',B='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M576 304C576 436.5 461.4 544 320 544C282.9 544 247.7 536.6 215.9 523.3L97.5 574.1C88.1 578.1 77.3 575.8 70.4 568.3C63.5 560.8 62 549.8 66.8 540.8L115.6 448.6C83.2 408.3 64 358.3 64 304C64 171.5 178.6 64 320 64C461.4 64 576 171.5 576 304z"/></svg>',N=document.querySelector(".lds-ripple-container");function M(n){const m=document.getElementById("section1"),a=document.getElementById("load-more");if(!m||!a)return;let r=1,t=[];window.__allPhotos=t;async function e(l){try{return(await(await fetch(`https://image-feed-api.vercel.app/api/images?page=${l}`)).json()).data.map(c=>({id:c.id,src:c.image_url,likes_count:c.likes_count??0,comments:Array.isArray(c.comments)?c.comments:[]}))}catch(u){return console.error("Error loading API:",u),[]}}function d(l){l.forEach((u,L)=>{const c=document.createElement("div");c.className="photo-card",c.dataset.photoId=u.id;const h=document.createElement("img");h.id=u.id,h.src=u.src,h.alt="photo",h.addEventListener("click",()=>n(L,l));const g=document.createElement("div");g.className="actions";const v=document.createElement("span");v.className="likes",v.innerHTML=`${I} ${u.likes_count} Likes`;const k=Array.isArray(u.comments)?u.comments.length:0,w=document.createElement("span");w.className="comments-info",w.innerHTML=`${B} ${k} ${k===1?"Comment":"Comments"}`,g.appendChild(v),g.appendChild(w),c.appendChild(h),c.appendChild(g),m.appendChild(c),t.some(E=>E.id===u.id)||t.push(u)})}async function y(){a.style.opacity="0",await new Promise(requestAnimationFrame);const l=[...await e(r),...await e(r+1),...await e(r+2)];d(l),N.remove(),a.style.opacity="1"}y(),a.addEventListener("click",()=>{r=r+3,y()})}function _(n,m){m.querySelectorAll(".comments-container").forEach(o=>o.remove());const a=document.createElement("div");a.className="comments-container";const r=document.createElement("h2");r.textContent="Comments",a.appendChild(r);const t=document.createElement("p");t.classList.add("comments-info"),a.appendChild(t);const e=document.createElement("div");e.classList.add("container-btn");const d=document.createElement("button");d.classList.add("comments-show-more-btn"),d.textContent="Show more";const y=document.createElement("button");y.classList.add("your-comment-btn"),y.textContent="Comment",e.appendChild(d),e.appendChild(y);const l=document.getElementById("comments-popup"),u=l.querySelector("form"),L=l.querySelector(".input-name"),c=l.querySelector(".input-comment");let h=3,g=Array.isArray(n.comments)?[...n.comments].reverse():[];const v=document.createElement("ul");v.classList.add("comments-list"),a.appendChild(v);const k=()=>{const o=g.length,s=v.querySelectorAll(".comment").length;t.textContent=`${s} of ${o} comments`},w=()=>{l.classList.add("active")},E=()=>{l.classList.remove("active")},i=()=>{if(v.innerHTML="",g.length===0){const o=document.createElement("li");o.className="comment";const s=document.createElement("p");s.className="comment-text",s.textContent="No comments yet.",o.appendChild(s),v.appendChild(o),d.style.display="none",t.textContent="0 of 0 comments";return}g.slice(0,h).forEach(o=>{const s=document.createElement("li");s.className="comment";const f=document.createElement("p");f.className="comment-author",f.textContent=`Author: ${o.commenter_name}`;const C=document.createElement("p");C.className="comment-text",C.textContent=o.comment,s.appendChild(C),s.appendChild(f),v.appendChild(s)}),k(),d.style.display=h>=g.length?"none":"block"},p=async o=>{o.preventDefault();const s=L.value.trim(),f=c.value.trim();if(!s||!f)return;const C=n.id;if(!C){console.error("âŒ Missing photo ID, please reopen the popup");return}try{const b=await fetch(`https://image-feed-api.vercel.app/api/images/${C}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({commenter_name:s,comment:f})});if(!b.ok)throw new Error("Failed to post comment");const $=await b.json();if($.success){const q=$.comment;g.unshift(q),Array.isArray(n.comments)||(n.comments=[]),n.comments.unshift(q),i(),L.value="",c.value="",E();const S=document.querySelector(`.photo-card[data-photo-id="${C}"]`)?.querySelector(".comments-info");if(S){const P=S.querySelector("svg")?.outerHTML||"",x=n.comments.length;S.innerHTML=`${P} ${x} ${x===1?"Comment":"Comments"}`}}}catch(b){console.error("Error posting comment:",b),alert("Something went wrong while posting your comment ðŸ˜¢")}};u.removeEventListener("submit",p),u.addEventListener("submit",p),d.addEventListener("click",()=>{h+=3,i()}),y.addEventListener("click",w),l.addEventListener("click",o=>{o.target.classList.contains("comments-popup")&&E()}),i(),a.appendChild(e),m.appendChild(a)}function T(){const n=document.createElement("div"),m=document.body;n.id="Image-popup",n.className="hidden",n.innerHTML=`
    <div class="popup-card">
      <span id="close-popup">&times;</span>

      <div class="popup-left">
        <img id="popup-img" src="" alt="popup image">
      </div>

      <div class="popup-right">
      
      </div>

      
</div>

 <button id="prev-popup" class="popup-nav">&#10094;</button>
 <button id="next-popup" class="popup-nav">&#10095;</button>
    

 `,document.body.appendChild(n);const a=n.querySelector("#popup-img"),r=n.querySelector("#close-popup"),t=n.querySelector("#like-btn"),e=t.querySelector(".icon"),d=t.querySelector(".count"),y=n.querySelector("#prev-popup"),l=n.querySelector("#next-popup"),u=n.querySelector(".popup-right");let L=null,c=0,h=[];const g=new Set;r.addEventListener("click",async()=>{n.classList.add("hidden"),m.classList.remove("popup-open"),g.size>0&&(await Promise.all([...g].map(i=>k(i))),g.clear())}),t.addEventListener("click",async()=>{L&&await v(L)});async function v(i){try{const o=await(await fetch(`https://image-feed-api.vercel.app/api/images/${i}/like`,{method:"POST",headers:{"Content-Type":"application/json"}})).json();if(o.success){const s=o.likes_count??0;d.textContent=`${s} ${s===1?"Like":"Likes"}`;const f=e.querySelector("svg");f&&(f.style.fill="red"),g.add(i),await w(i,s)}}catch(p){console.error("Error liking image:",p)}}async function k(i){try{const o=await(await fetch(`https://image-feed-api.vercel.app/api/images/${i}`)).json();if(!o)return;w(o.id,o.likes_count??0)}catch(p){console.error(p)}}async function w(i,p){const o=document.querySelector(`.photo-card[data-photo-id="${i}"]`);if(o){const f=o.querySelector(".likes");f&&(f.innerHTML=`${I} ${p} ${p===1?"Like":"Likes"}`)}const s=window.__allPhotos?.find(f=>f.id===i);s&&(s.likes_count=p)}async function E(){const i=h[c];if(i){a.src=i.src,L=i.id;try{const s=(await(await fetch(`https://image-feed-api.vercel.app/api/images/${L}`)).json()).likes_count??0;d.textContent=`${s} ${s===1?"Like":"Likes"}`;const f=I.replace(/\n/g,"");e.innerHTML=f;const C=e.querySelector("svg");C&&(C.style.fill="black"),_(i,u)}catch(p){console.error(p)}}}return y.addEventListener("click",async()=>{c=(c-1+h.length)%h.length,await E()}),l.addEventListener("click",async()=>{c=(c+1)%h.length,await E()}),function(p,o){h=o,c=p;const s=h[c];L=s.id,a.src=s.src,n.classList.remove("hidden"),m.classList.add("popup-open"),E()}}const F=T();A();M(F);
